# 权限设计模型

## DAC

### 含义

自主访问控制（Discretionary Access Control）：

系统识别用户，根据被操作**对象（Subject）**的**权限控制列表**（**ACL**：Access Control List）或者**权限控制矩阵**（**ACM**: Access Control Matrix）决定用户是否能够对其进行操作，能进行哪些操作。

拥有对象权限的用户，可以将该**对象的权限分配给其他用户**，所以称为“**自主（Discretionary）**”控制。

常见应用于**文件系统的权限设计**，例如微软的**NTFS（New Technology File System）**文件系统。

### 特点

缺点：权限控制分散，不便于管理。如无法将一组文件设置统一的权限开放给一群用户。

## MAC

### 含义

强制访问控制（Mandatory Access Control）

MAC是为了解决DAC权限控制过于分散的问题而诞生的。MAC中每个文件都有一些权限标识，每个用户也有一些权限标识。用户能否对该对象进行操作，取决于两者标识的关系。权限关系的判断是由硬件限制的。

常见于机密机构或者一些等级机构观念强烈的行业。

### 特点

不够灵活，难以使用

## RBAC

### 含义

由于DAC和MAC的诸多限制，所以诞生了RBAC（Role-Based Access Control）。

**用户（user）关联角色（role），角色（role）关联权限（permission/access）**。

一个用户可以有多个角色，一个角色可以对应多个权限。

从数据库设计上看，需要有**5张表：user、role、access、user-role、role-access**。

最终想要的目的是：从用户得到用户所具有的权限。



### 扩展

#### 角色继承（Hierarchy Role）

角色可以**继承其他角色且能添加自己的权限**。便于**角色分层和分组**，简化管理。



#### 职责分离（Separation of Duty）

避免用户拥有**过多权限而产生利益冲突**（如运动员同时具有裁判的权限），一种职责分离扩展版本的RBAC被提出。

两种模式：

- 静态职责分离：用户无法同时被赋予有冲突的角色。
- 动态职责分离：用户再一次会话中无法同时激活自身拥有的、相互有冲突的角色，只能选择其一。

## 基于属性的权限认证

### 含义

ABAC：Attribute-Based Access Control

不同于将用户关联到权限的方式，**ABAC通过动态计算一个或者一组属性是否满足给定的限定条件进行授权判断**。

属性通常分为四类：

- **用户属性**：如年龄、性别、姓名等。
- **环境属性**：如时间、地点等。
- **操作属性**：如读、取，进、出等。
- **对象属性**：又称为资源属性，如一片文章等。

ABAC非常灵活，理论上可以满足所有类型需求。例如规则 “允许所有班主任在上课时间自由进出校门”，其中，“班主任”是用户角色属性，“上课时间” 是环境属性，“进出”是操作属性，“校门”是对象属性。

为了实现便捷的规则设置和规则判断，ABAC通常有配置文件（YAML，XML）或者DSL（Domain Specific Language）配合规则解析引擎使用。

### 特点

- 集中化管理
- 按需实现不同粒度的权限控制
- 不需要预定义判断逻辑，减轻了权限系统的维护成本
- 权限判断需要实时执行，规则过多会导致性能问题。